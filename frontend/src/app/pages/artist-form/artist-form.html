<div class="form-container">
  <div class="form-card">
    <div class="form-header">
      <a routerLink="/home" class="back-link">← Voltar</a>
      <h1>{{ isEditMode() ? 'Editar Artista' : 'Adicionar Novo Artista' }}</h1>
    </div>

    @if (artistFacade.isLoading()) {
    <div class="loading-box">
      <span class="material-icons spinning">sync</span>
      <p>Carregando dados...</p>
    </div>
    } @else {
    <form [formGroup]="artistForm" (ngSubmit)="onSubmit()" class="artist-form">
      @if (artistFacade.errorMessage()) {
      <div class="error-box">
        {{ artistFacade.errorMessage() }}
      </div>
      }

      <XInput label="Nome do Artista" placeholder="Ex: Pink Floyd, Alok, etc." formControlName="name" />

      <div class="form-group">
        <label for="description">Descrição / Biografia</label>
        <textarea id="description" formControlName="description"
          placeholder="Conte um pouco sobre a história do artista..." rows="5"></textarea>
      </div>

      <div class="form-group">
        <XSelectManyAlbums label="Álbuns" placeholder="Selecione os álbuns do artista" formControlName="albumIds">
        </XSelectManyAlbums>
        <div class="quick-create">
          <span>Não encontrou o álbum? </span>
          <button type="button" class="link-btn" (click)="showQuickAlbumModal.set(true)">Crie-o rapidamente</button>
        </div>
      </div>

      <div class="actions">
        <XButton type="submit" [disabled]="artistForm.invalid || artistFacade.isLoading()">
          @if (artistFacade.isLoading()) {
          Salvando...
          } @else {
          {{ isEditMode() ? 'Salvar Alterações' : 'Salvar Artista' }}
          }
        </XButton>
      </div>
    </form>
    }
  </div>

  @if (showQuickAlbumModal()) {
  <QuickAlbumModal [artistId]="artistId()" (close)="showQuickAlbumModal.set(false)" (saved)="onQuickAlbumSaved($event)">
  </QuickAlbumModal>
  }
</div>
